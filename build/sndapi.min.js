!function(e){"use strict";e.SNDAPI=e.SNDAPI||function(e){function t(){return{tokenIsSet:!!c.token,tokenTimerIsSet:!!c.tokenTimer}}function n(){if(!a.key)throw new Error("API key is required for SND API initalization");r(),c.tokenTimer&&clearInterval(c.tokenTimer),c.tokenTimer=setInterval(r,a.refreshInterval)}function r(){s({sign:!1,url:a.signatureServiceUrl+"?api-key="+a.key}).success(function(e,t){c.token=e.token,l("token: "+c.token),l(t)}).fail(function(e){p(e)})}function o(e,t){var n,r={},o=Object.hasOwnProperty;for(n in e)o.call(e,n)&&(r[n]=e[n]);if("object"==typeof t)for(n in t)o.call(t,n)&&(r[n]=t[n]);return r}function s(e){function t(){var e;if("success"===f)for(;e=l.pop();)e(d.response,d);else for(;e=p.pop();)e(d)}function n(){return f&&t(),k}var r=o({url:null,postData:null,sign:!0},e),s=i(),u=r.postData?"POST":"GET",l=[],p=[],f=null,d={response:null},k={};return/^http/.test(r.url)||(r.url=a.prefixUrl+r.url),k.success=function(e){return l.push(e),n()},k.fail=function(e){return p.push(e),n()},s?(k.req=s,s.open(u,r.url,!0),c.token&&r.sign&&s.setRequestHeader("x-snd-apisignature",c.token),r.postData&&s.setRequestHeader("Content-type","application/x-www-form-urlencoded"),r.preferJSON&&s.setRequestHeader("Accept","application/javascript, application/json"),s.onreadystatechange=function(){4===s.readyState&&(200!==s.status&&304!==s.status?(f="fail",d={statusCode:s.status,statusText:s.statusText,response:s.responseText}):(f="success",d={statusCode:s.status,statusText:s.statusText,response:s.responseText},"application/json"===s.getResponseHeader("Content-Type")&&JSON&&(d.response=JSON.parse(d.response))),t())},4===s.readyState?void(console&&console.warn("I did not expect to get here")):(s.send(r.postData),k)):(f="fail",k)}function i(){for(var e=!1,t=0;t<f.length;t++){try{e=f[t]()}catch(n){continue}break}return e}var u,a=o({refreshInterval:18e5,signatureServiceUrl:"http://apitestbeta3.medianorge.no/sts/signature",prefixUrl:"http://api.snd.no/news/v2/",key:null},e),c={token:null,tokenTimer:null},l=function(e){console.log(e)},p=function(e){console.error(e)},f=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}];return u={init:n,getState:t,ajax:s}}}("object"==typeof global?global:this),"undefined"!=typeof module&&module.exports&&(module.exports=SNDAPI);