!function(e){"use strict";e.SNDAPI=e.SNDAPI||function(e){function t(){if(!a.key)throw new Error("API key is required for SND API initalization");n(),c.tokenTimer&&clearInterval(c.tokenTimer),c.tokenTimer=setInterval(n,a.refreshInterval)}function n(){o({sign:!1,url:a.signatureServiceUrl+"?api-key="+a.key}).success(function(e,t){c.token=e.token,l("token: "+c.token),l(t)}).fail(function(e){p(e)})}function r(e,t){var n,r={},o=Object.hasOwnProperty;for(n in e)o.call(e,n)&&(r[n]=e[n]);if("object"==typeof t)for(n in t)o.call(t,n)&&(r[n]=t[n]);return r}function o(e){function t(){var e;if("success"===f)for(;e=l.pop();)e(d.response,d);else for(;e=p.pop();)e(d)}function n(){return f&&t(),k}var o=r({url:null,postData:null,sign:!0},e),i=s(),u=o.postData?"POST":"GET",l=[],p=[],f=null,d={response:null},T=!0,k={};return/^http/.test(o.url)||(o.url=a.prefixUrl+o.url),k.success=function(e){return l.push(e),n()},k.fail=function(e){return p.push(e),n()},i?(k.req=i,i.open(u,o.url,!0),c.token&&o.sign&&i.setRequestHeader("x-snd-apisignature",c.token),o.postData&&i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),T&&i.setRequestHeader("Accept","application/javascript, application/json"),i.onreadystatechange=function(){4===i.readyState&&(200!==i.status&&304!==i.status?(f="fail",d={statusCode:i.status,statusText:i.statusText,response:i.responseText}):(f="success",d={statusCode:i.status,statusText:i.statusText,response:i.responseText},"application/json"===i.getResponseHeader("Content-Type")&&JSON&&(d.response=JSON.parse(d.response))),t())},4===i.readyState?void(console&&console.warn("I did not expect to get here")):(i.send(o.postData),k)):(f="fail",k)}function s(){for(var e=!1,t=0;t<f.length;t++){try{e=f[t]()}catch(n){continue}break}return e}function i(){return{getToken:function(){return c.token},getTokenTimer:function(){return c.tokenTimer}}}var u,a=r({refreshInterval:18e5,signatureServiceUrl:"http://apitestbeta3.medianorge.no/sts/signature",prefixUrl:"http://api.snd.no/news/v2/",key:null},e),c={token:null,tokenTimer:null},l=function(e){console.log(e)},p=function(e){console.error(e)},f=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}];return u={init:t,ajax:o},QUnit&&(u.touch_private_parts=i),u}}("object"==typeof global?global:this),"undefined"!=typeof module&&module.exports&&(module.exports=SNDAPI);